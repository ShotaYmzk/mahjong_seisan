# ğŸ€„ éº»é›€ç²¾ç®— (Mahjong Settlement)

éº»é›€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ç²¾ç®—ã‚’å…±åŒç·¨é›†ã§ãã‚‹Webã‚¢ãƒ—ãƒªã€‚

## æ©Ÿèƒ½

- **åŠè˜ç®¡ç†**: è¤‡æ•°åŠè˜ã®ç´ ç‚¹å…¥åŠ›ã€åˆè¨ˆç‚¹ã®è‡ªå‹•æ¤œç®—
- **ãƒãƒƒãƒ—**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼é–“ã®ãƒãƒƒãƒ—ç§»å‹•ã‚’è¨˜éŒ²
- **ç«‹æ›¿**: é£²é£Ÿç­‰ã®ç«‹æ›¿ã‚’å‰²ã‚Šå‹˜è¨ˆç®—ï¼ˆå…¨å“¡/æŒ‡å®šï¼‰
- **ãƒ«ãƒ¼ãƒ«è¨­å®š**: èµ·ç‚¹ç‚¹æ•°/è¿”ã—ç‚¹/ã‚¦ãƒ/ã‚ªã‚«/ãƒ¬ãƒ¼ãƒˆ/ãƒãƒƒãƒ—å˜ä¾¡
- **ç²¾ç®—çµæœ**: æœ€çµ‚å·®é¡ã®è‡ªå‹•è¨ˆç®— + é€é‡‘ãƒªã‚¹ãƒˆ + LINEã‚³ãƒ”ãƒšæ–‡
- **å…±åŒç·¨é›†**: Supabase Realtimeã§å³æ™‚åæ˜ 
- **æ¥½è¦³ãƒ­ãƒƒã‚¯**: ç«¶åˆæ›´æ–°ã‚’æ¤œå‡ºã—ã¦ä¸Šæ›¸ãäº‹æ•…ã‚’é˜²æ­¢
- **RLS**: Roomãƒ¡ãƒ³ãƒãƒ¼ã®ã¿ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆ**: Next.js 16 (App Router) + TypeScript + Tailwind CSS v4
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Supabase (Postgres + Auth + Realtime + RLS)
- **ãƒ†ã‚¹ãƒˆ**: Vitest

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. ç’°å¢ƒå¤‰æ•°

```bash
cp .env.local.example .env.local
```

`.env.local` ã« Supabase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æƒ…å ±ã‚’å…¥åŠ›:

```
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
```

### 2. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install
```

### 3. Supabase CLI ã®è¨­å®š

```bash
npx supabase login
npx supabase link --project-ref <your-project-ref>
```

### 4. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨

```bash
npx supabase db push
```

### 5. Supabase Dashboard ã§ã®è¨­å®š

1. **Authentication** â†’ **Settings** â†’ **Anonymous Sign-in** ã‚’æœ‰åŠ¹åŒ–
2. **Database** â†’ **Replication** ã§ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã® Realtime ã‚’æœ‰åŠ¹åŒ–:
   - `hanchan`
   - `round_results`
   - `chip_events`
   - `expenses`
   - `expense_shares`
   - `rule_sets`

### 6. å‹ç”Ÿæˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

```bash
npm run gen:types
```

### 7. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
npm run dev
```

## ãƒ†ã‚¹ãƒˆ

```bash
npm test
```

## è¨ˆç®—ä»•æ§˜

### åŠè˜â†’éº»é›€åæ”¯

1. å„ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ç´ ç‚¹ã¨è¿”ã—ç‚¹ã®å·®åˆ†ã‚’ç®—å‡º
2. ã‚ªã‚«ï¼ˆãƒˆãƒƒãƒ—å–ã‚Šæ–¹å¼ï¼‰: (è¿”ã—ç‚¹ - é…çµ¦åŸç‚¹) Ã— 4 ã‚’1ä½ã«åŠ ç®—
3. ã‚¦ãƒã‚’é †ä½ã«å¿œã˜ã¦åŠ ç®—
4. ãƒ¬ãƒ¼ãƒˆï¼ˆå††/åƒç‚¹ï¼‰ã§å††æ›ç®—
5. ä¸¸ã‚å˜ä½ã§å››æ¨äº”å…¥
6. åˆè¨ˆç‚¹ãŒä¸ä¸€è‡´ã®åŠè˜ã¯ã€Œæœªç¢ºå®šã€ã¨ã—ã¦ç²¾ç®—ã‹ã‚‰é™¤å¤–

### ãƒãƒƒãƒ—

æ•°é‡ Ã— ãƒãƒƒãƒ—å˜ä¾¡ã§å††æ›ç®—ã—ã€æœ€çµ‚å·®é¡ã«åŠ ç®—

### ç«‹æ›¿

æ”¯æ‰•è€…ã®å…¨é¡ã‚’å¯¾è±¡è€…ã§ç­‰åˆ†ã€‚ç«¯æ•°ã¯å…ˆé ­ã®å¯¾è±¡è€…ã‹ã‚‰1å††ãšã¤é…åˆ†

### é€é‡‘ãƒªã‚¹ãƒˆ

è²ªæ¬²æ³•ã§é€é‡‘æœ¬æ•°ã‚’æœ€å°åŒ–

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
src/
â”œâ”€â”€ app/                  # Next.js App Router ãƒšãƒ¼ã‚¸
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/              # å…±é€šUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ room/            # ãƒ«ãƒ¼ãƒ é–¢é€£
â”‚   â””â”€â”€ session/         # ã‚»ãƒƒã‚·ãƒ§ãƒ³é–¢é€£ï¼ˆ5ã¤ã®ã‚¿ãƒ–ï¼‰
â”œâ”€â”€ domain/              # ç´”é–¢æ•°ã®è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ hanchan.ts       # åŠè˜è¨ˆç®—
â”‚   â”œâ”€â”€ chip.ts          # ãƒãƒƒãƒ—è¨ˆç®—
â”‚   â”œâ”€â”€ expense.ts       # ç«‹æ›¿è¨ˆç®—
â”‚   â”œâ”€â”€ settlement.ts    # å…¨ä½“ç²¾ç®—
â”‚   â”œâ”€â”€ transfer.ts      # é€é‡‘æœ€é©åŒ–
â”‚   â””â”€â”€ __tests__/       # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ hooks/               # React hooks
â”œâ”€â”€ lib/supabase/        # Supabase ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â””â”€â”€ types/               # å‹å®šç¾©
supabase/migrations/     # SQLãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ7ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
```
